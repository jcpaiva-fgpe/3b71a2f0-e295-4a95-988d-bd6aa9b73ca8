SELECT COUNTRY_NAME, COUNT(DEPARTMENT_ID) AS "N. DEPARTMENTS"
FROM (COUNTRIES NATURAL JOIN REGIONS) LEFT JOIN LOCATIONS USING (COUNTRY_ID) LEFT JOIN DEPARTMENTS USING (LOCATION_ID)
WHERE REGION_NAME = 'Europe'
GROUP BY COUNTRY_NAME
ORDER BY COUNTRY_NAME