<h2><code>UNION</code></h2><p>En las operaciones que veremos en este apartado intervienen varias consultas <code>SELECT</code>. En concreto, en la operaci&oacute;n <code>UNION</code>, se combinan las filas del primer <code>SELECT</code> con las filas del segundo <code>SELECT</code>, desapareciendo las filas duplicadas.</p><h3>Sintaxis</h3><blockquote><p><code>SELECT query</code></p><p><code>UNION</code></p><p><code>SELECT query</code></p></blockquote><p>El n&uacute;mero de columnas que devuelven ambas consultas SELECT debe ser el mismo y los tipos de dichas columnas deben ser compatibles.</p><h3>Ejemplo:</h3><p>Muestra los empleados que est&aacute;n o han estado en el departamento 110:</p><p>En primer lugar, vamos a buscar a los empleados que est&aacute;n (employees) en el departamento 110</p><blockquote><p><code>SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID<br />FROM employees<br />WHERE DEPARTMENT_ID = 110;</code></p></blockquote><table align="center" border="1" summary="Results from query"><tbody><tr><th style="background-color:#9e9e9e; text-align:center">EMPLOYEE_ID</th><th style="background-color:#9e9e9e; text-align:center">DEPARTMENT_ID</th></tr><tr><td>205</td><td>110</td></tr><tr><td>206</td><td>110</td></tr></tbody></table><p>Ahora buscaremos a los empleados que estuvieron en alg&uacute;n momento (job_history) en el departamento 110</p><blockquote><p><code>SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID<br />FROM job_history<br />WHERE DEPARTMENT_ID = 110;</code></p></blockquote><table align="center" border="1" summary="Results from query"><tbody><tr><th style="background-color:#9e9e9e; text-align:center">EMPLOYEE_ID</th><th style="background-color:#9e9e9e; text-align:center">DEPARTMENT_ID</th></tr><tr><td>101</td><td>110</td></tr></tbody></table><p>Por &uacute;ltimo, combinamos ambos resultados para alcanzar la consulta que se requer&iacute;a:</p><blockquote><p><code>SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID<br />FROM employees<br />WHERE DEPARTMENT_ID = 110<br /><strong>UNION</strong><br />SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID<br />FROM job_history<br />WHERE DEPARTMENT_ID = 110;</code></p></blockquote><table align="center" border="1" summary="Results from query"><tbody><tr><th style="background-color:#9e9e9e; text-align:center">EMPLOYEE_ID</th><th style="background-color:#9e9e9e; text-align:center">DEPARTMENT_ID</th></tr><tr><td>101</td><td>110</td></tr><tr><td>205</td><td>110</td></tr><tr><td>206</td><td>110</td></tr></tbody></table><p>Naturalmente, lo l&oacute;gico ser&iacute;a mostrar los nombres y apellidos de los empleados, en lugar de su identificador, por lo que una respuesta con m&aacute;s informaci&oacute;n ser&iacute;a:</p><blockquote><p><code>SELECT DISTINCT FIRST_NAME, LAST_NAME, DEPARTMENT_ID<br />FROM employees<br />WHERE DEPARTMENT_ID = 110<br />UNION<br />SELECT DISTINCT FIRST_NAME, LAST_NAME, job_history.DEPARTMENT_ID<br />FROM job_history JOIN employees USING (EMPLOYEE_ID)<br />WHERE job_history.DEPARTMENT_ID = 110;</code></p></blockquote><table align="center" border="1" summary="Results from query"><tbody><tr><th style="text-align: center; background-color: rgb(158, 158, 158);">FIRST_NAME</th><th style="text-align: center; background-color: rgb(158, 158, 158);">LAST_NAME</th><th style="text-align: center; background-color: rgb(158, 158, 158);">DEPARTMENT_ID</th></tr><tr><td>Neena</td><td>Kochhar</td><td>110</td></tr><tr><td>Shelley</td><td>Higgins</td><td>110</td></tr><tr><td>William</td><td>Gietz</td><td>110</td></tr></tbody></table><h3>Ejercicio</h3><p>Neena Kochhar no se encuentra c&oacute;moda en el departamento actual, por lo que est&aacute; viendo la opci&oacute;n de mudarse a California o de volver a alguno de los departamentos en los que ya ha estado trabajando.</p><p>&iquest;Cu&aacute;les son los departamentos que o bien est&aacute;n en el estado de &#39;<code>California</code>&#39; o bien <code>Neena Kochhar</code> ya estuvo trabajando en ellos con anterioridad?</p>