<p>A cláusula <code>HAVING</code> permite estabelecer critérios nas linhas resultantes após a aplicação de uma <code>GROUP BY</code>.</p><h3>Sintaxe:</h3><p>A cláusula <code>HAVING</code> Vamos pô-lo. <code>inmediatamente después del GROUP BY</code>, uma vez que seus critérios serão aplicados nas linhas geradas pelo agrupamento.</p><blockquote><p><code>SELECT columna1, columna2, ...<br/>FROM tabla1, tabla2, ...<br/>WHERE condición1, condición2, …<br/><strong>GROUP BY columna1, columna2, …<br/>HAVING condición1, condición2, …</strong><br/>ORDER BY ordenación;</code></p></blockquote><p>É muito importante entender que, a partir deste momento, temos 2 lugares onde os critérios de seleção podem ser estabelecidos:</p><ul><li><code>WHERE</code>: seus critérios são avaliados antes do agrupamento.</li><li><code>HAVING</code>: seus critérios são avaliados após o agrupamento.</li></ul><h3>Exemplo:</h3><p>Em um exemplo anterior, vimos como mostrar o salário médio de todos os funcionários por departamentos. Nesta ocasião, em vez de usar todos os departamentos para calcular o salário médio, usaremos apenas aqueles funcionários cujo trabalho contém a palavra <em>CLERK</em>:</p><blockquote><p><code>SELECT DEPARTMENT_ID, ROUND(AVG(SALARY)) AS "AVERAGE SALARY"<br/>FROM employees<br/><strong>WHERE JOB_ID LIKE '%CLERK%'</strong><br/>GROUP BY DEPARTMENT_ID;</code></p></blockquote><table align="center" border="1" summary="Results from query"><tbody><tr><th style="background-color:#9e9e9e; text-align:center">DEPARTAMENTO</th><th style="background-color:#9e9e9e; text-align:center">AVALIAÇÃO</th></tr><tr><td style="text-align:center">50</td><td>3000.</td></tr><tr><td style="text-align:center">30</td><td>2780</td></tr></tbody></table><p>O critério de que o trabalho dos empregados deve conter a CLERK que tivemos de colocar na cláusula <code>WHERE</code>pois, como você pode ver, após o agrupamento, não temos mais dados <code>JOB_ID</code>.</p><p>Na cláusula HAVING, só podemos estabelecer critérios para os dados disponíveis após o agrupamento, ou seja, os dados na tabela anterior. Por exemplo, podemos querer mostrar apenas os departamentos em que os salários médios dos funcionários que realizam um trabalho contendo CLERK foram inferiores a 3000:</p><blockquote><p><code>SELECT DEPARTMENT_ID, ROUND(AVG(SALARY)) AS "AVERAGE SALARY"<br/>FROM employees<br/>WHERE JOB_ID LIKE '%CLERK%'<br/>GROUP BY DEPARTMENT_ID<br/><strong>HAVING AVG(SALARY) < 3000</strong>;</code></p></blockquote><table align="center" border="1" summary="Results from query"><tbody><tr><th style="background-color:#9e9e9e; text-align:center">DEPARTAMENTO</th><th style="background-color:#9e9e9e; text-align:center">AVALIAÇÃO</th></tr><tr><td style="text-align:center">30</td><td>2780</td></tr></tbody></table><h3>Exercício:</h3><p>Mostra o salário <em>MÍNIMO</em> e <em>MÁXIMO</em> de empregados de cada um dos tipos de trabalho existentes.</p><p>Ela exclui do agrupamento aqueles em que MINE e MÁXIMO são iguais.</p><p>Ordenar o resultado alfabeticamente, em ordem ASCENDENTE, de acordo com o tipo de trabalho.</p>