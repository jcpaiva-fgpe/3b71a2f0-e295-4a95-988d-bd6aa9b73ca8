<h3>Arithmetiska datum.</h3><p>Innan du börjar med datumfunktionerna är det viktigt att förstå att vi kan göra vissa aritmetiska operationer med datumen.</p><p>Vi kan till exempel öka eller minska ett datum i ett antal dagar (även med fraktioner av dagar).</p><blockquote><p><code>SELECT<br/>    CURRENT_DATE -1 AS "YESTERDAY",<br/>    CURRENT_DATE AS "TODAY",<br/>    CURRENT_DATE + 1 AS "TOMORROW";</code></p></blockquote><table align="center" border="1" summary="Results from query 39"><tbody><tr><th style="background-color:#9e9e9e; text-align:center">JESTERDAG</th><th style="background-color:#9e9e9e; text-align:center">Alla dagar</th><th style="background-color:#9e9e9e; text-align:center">Tomorrow</th></tr><tr><td>2022-09-22</td><td>2022-09-23</td><td>2022-09-24</td></tr></tbody></table><blockquote><p><em><code>CURRENT_DATE</code>Returnerar aktuellt datum.</em></p></blockquote><p>Senare kan vi även subtrahera 2 datum och veta antalet dagar mellan dem.</p><p>Men förutom dagar kan vi också lägga till eller subtrahera tidsintervaller.</p><p>Vi kan till exempel öka eller minska ett datum om ett antal månader.</p><blockquote><p><code>SELECT<br/>    CURRENT_DATE - interval '1 month' AS "LAST MONTH",<br/>    CURRENT_DATE AS "TODAY",<br/>    CURRENT_DATE + interval '1 month' AS "NEXT MONTH";</code></p></blockquote><table align="center" border="1" summary="Results from query 39"><tbody><tr><th style="background-color:#9e9e9e; text-align:center">Förra månaden</th><th style="background-color:#9e9e9e; text-align:center">Alla dagar</th><th style="background-color:#9e9e9e; text-align:center">Nästa månad</th></tr><tr><td>2022-08-23 00:00:00</td><td>2022-09-23</td><td>2022-10-23 00:00:00</td></tr></tbody></table><blockquote><p><em><code>CURRENT_DATE</code>Returnerar aktuellt datum.</em></p></blockquote><p>Senare kan vi även subtrahera 2 datum och veta antalet dagar mellan dem.</p><h3>Datumfunktioner</h3><p>Nedan finns en tabell med vissa datumfunktioner, tillsammans med resultatet de returnerar.</p><table align="center" border="1" cellspacing="0" style="border-collapse:collapse; width:NaN"><tbody><tr><td style="background-color:#9e9e9e; border-color:#9e9e9e; border-style:solid; border-width:1px; text-align:center; vertical-align:top"><p><strong>Funktion</strong></p></td></tr></tbody></table><td style="background-color:#9e9e9e; border-color:#9e9e9e; border-style:solid; border-width:1px; text-align:center; vertical-align:top"><p><strong>Beskrivning</strong></p></td><tr><td style="border-bottom:1px solid #9e9e9e; border-left:1px solid #9e9e9e; border-right:1px solid #9e9e9e; border-top:1px solid #9e9e9e; vertical-align:top"><p><code><strong>AGE ( timestamp, timestamp ) → interval</strong></code></p></td></tr><td style="border-bottom:1px solid #9e9e9e; border-left:1px solid #9e9e9e; border-right:1px solid #9e9e9e; border-top:1px solid #9e9e9e; vertical-align:top"><p>Returnerar ett resultat i år, månader och dagar istället för bara dagar.</p></td><tr><td style="border-bottom:1px solid #9e9e9e; border-left:1px solid #9e9e9e; border-right:1px solid #9e9e9e; border-top:1px solid #9e9e9e; vertical-align:top"><p><code><strong>DATE_TRUNC ( text, timestamp ) → timestamp</strong></code></p></td></tr><td style="border-bottom:1px solid #9e9e9e; border-left:1px solid #9e9e9e; border-right:1px solid #9e9e9e; border-top:1px solid #9e9e9e; vertical-align:top"><p>Returnerar det truncerade datumet till den angivna noggrannheten.</p></td><tr><td style="border-bottom:1px solid #9e9e9e; border-left:1px solid #9e9e9e; border-right:1px solid #9e9e9e; border-top:1px solid #9e9e9e; vertical-align:top"><p><code><strong>EXTRACT ( field from timestamp ) → numeric<br/>EXTRACT ( field from interval ) → numeric</strong></code></p></td></tr><td style="border-bottom:1px solid #9e9e9e; border-left:1px solid #9e9e9e; border-right:1px solid #9e9e9e; border-top:1px solid #9e9e9e; vertical-align:top"><p>Returnerar det valda fältet för datumet.</p></td><tr><td style="border-bottom:1px solid #9e9e9e; border-left:1px solid #9e9e9e; border-right:1px solid #9e9e9e; border-top:1px solid #9e9e9e; vertical-align:top"><p><code><strong>MAKE_DATE ( year int, month int, day int ) → date</strong></code></p></td></tr><td style="border-bottom:1px solid #9e9e9e; border-left:1px solid #9e9e9e; border-right:1px solid #9e9e9e; border-top:1px solid #9e9e9e; vertical-align:top"><p>Skapa ett datum från årets parametrar, månaden och dagen.</p></td><tr><td style="border-bottom:1px solid #9e9e9e; border-left:1px solid #9e9e9e; border-right:1px solid #9e9e9e; border-top:1px solid #9e9e9e; vertical-align:top"><p><code><strong>NOW()</strong></code></p></td></tr><td style="border-bottom:1px solid #9e9e9e; border-left:1px solid #9e9e9e; border-right:1px solid #9e9e9e; border-top:1px solid #9e9e9e; vertical-align:top"><p>Returnerar systemets datum, med beaktande av tidszonen.</p></td><p>Den fullständiga listan över funktioner kan erhållas från dokumentationen <a href="https://www.postgresql.org/docs/14/functions-datetime.html">Datum och tidsfunktioner i PostgreSQL</a>.</p><h3>Exempel:</h3><p>Vem har varit engagerad i företaget i mer än 30 år:<ol><li>Vi använder funktionen <code>AGE</code> att veta <em>"ålder "</em> från dagen för rekrytering (<code>HIRE_DATE</code>fram till nuet</li><li>Av det resultatet får vi åren med <code>EXTRACT</code></li><li>jämfört resultatet till 30</li></ol></p><blockquote><p><code>SELECT FIRST_NAME, LAST_NAME, HIRE_DATE<br/>FROM employees<br/>WHERE EXTRACT(year from AGE(CURRENT_DATE, HIRE_DATE)) >= 30<br/>ORDER BY HIRE_DATE;</code></p></blockquote><table align="center" border="1" summary="Results from query "><tbody><tr><th style="background-color:#9e9e9e; text-align:center">FIRST_NAME</th><th style="background-color:#9e9e9e; text-align:center">LAST_NAME</th><th style="background-color:#9e9e9e; text-align:center">HIRE_DATE</th></tr><tr><td>Steven</td><td>Kungen King</td><td>1987-06-17 00:00:00</td></tr><tr><td>Jennifer</td><td>Whalen</td><td>1987-09-17 00:00:00</td></tr><tr><td>Baby.</td><td>Kochhar</td><td>1989-09-21 00:00:00</td></tr><tr><td>Alexander Alexander</td><td>Hunold</td><td>1990-01-03 00:00:00</td></tr><tr><td>Bruce.</td><td>Ernst</td><td>1991-05-21 00:00:00</td></tr></tbody></table><h3>Övning:</h3><p>Baserat på föregående exempel, använd funktionen <code>MAKE_DATE</code> för att få anställda som var mer än 25 år, den 31 december 2020.</p><p>Beställ resultatet alfabetiskt av efternamnen.</p>